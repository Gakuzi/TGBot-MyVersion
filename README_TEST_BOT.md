# ü§ñ –¢–µ—Å—Ç–æ–≤—ã–π Telegram –±–æ—Ç –¥–ª—è Google –¢–∞–±–ª–∏—Ü

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **TGbot** –≤ —Ä–∞–±–æ—Ç–µ —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
TGBot/
‚îú‚îÄ‚îÄ bot/                    # –ò—Å—Ö–æ–¥–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ TGbot
‚îÇ   ‚îú‚îÄ‚îÄ 1 Client.js
‚îÇ   ‚îú‚îÄ‚îÄ 1.1 Class Bot.js
‚îÇ   ‚îú‚îÄ‚îÄ 1.2 InputMedia.js
‚îÇ   ‚îú‚îÄ‚îÄ 1.3 KeyboardGenerator.js
‚îÇ   ‚îú‚îÄ‚îÄ 1.4 Calendar.js
‚îÇ   ‚îú‚îÄ‚îÄ 2 Validate functions.js
‚îÇ   ‚îú‚îÄ‚îÄ 3 Write functions.js
‚îÇ   ‚îú‚îÄ‚îÄ 4 Do.js
‚îÇ   ‚îú‚îÄ‚îÄ Func.js
‚îÇ   ‚îú‚îÄ‚îÄ Helper.js
‚îÇ   ‚îú‚îÄ‚îÄ Types.js
‚îÇ   ‚îî‚îÄ‚îÄ Utils.js
‚îú‚îÄ‚îÄ src/                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ LICENSE
‚îÇ   ‚îú‚îÄ‚îÄ README_RU.md
‚îÇ   ‚îú‚îÄ‚îÄ tg.webp
‚îÇ   ‚îî‚îÄ‚îÄ types.png
‚îú‚îÄ‚îÄ test_bot.js            # –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–æ—Ç
‚îú‚îÄ‚îÄ simple_test_bot.js     # –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
‚îú‚îÄ‚îÄ examples.js            # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ SETUP_INSTRUCTIONS.md  # –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ QUICK_START.md         # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îî‚îÄ‚îÄ README_TEST_BOT.md     # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram
- –ù–∞–π–¥–∏—Ç–µ @BotFather
- –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
- –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω

### 2. –°–æ–∑–¥–∞–π—Ç–µ Google Apps Script –ø—Ä–æ–µ–∫—Ç
- –û—Ç–∫—Ä–æ–π—Ç–µ [script.google.com](https://script.google.com/)
- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É TGbot: `1LyGnqsaphk-K_EB8ZxqcBRiKXRE2TY8oSHWlZn4HBje1WlmoNk51wGeg`

### 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `simple_test_bot.js` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ `test_bot.js` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.

### 4. –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –†–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –∫–∞–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞

### ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** –≤ Google –¢–∞–±–ª–∏—Ü—ã
- **–í–µ–¥–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**
- **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã**
- **–û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤**
- **–û–ø—Ä–æ—Å—ã –∏ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã**
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å**
- **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö**

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã
–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ª–∏—Å—Ç—ã:
- **Messages** (—Å–∏–Ω–∏–π) - –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- **Users** (–∑–µ–ª–µ–Ω—ã–π) - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Debug** (–∫—Ä–∞—Å–Ω—ã–π) - –õ–æ–≥–∏ –æ—Ç–ª–∞–¥–∫–∏
- **Errors** (–æ—Ä–∞–Ω–∂–µ–≤—ã–π) - –û—à–∏–±–∫–∏

### üß™ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
```
/start - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
/help - –°–ø—Ä–∞–≤–∫–∞
/stats - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/users - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
/addme - –î–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è
/menu - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
```

## üìã –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

### `test_bot.js` - –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–æ—Ç
- –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ callback –∑–∞–ø—Ä–æ—Å–æ–≤
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### `simple_test_bot.js` - –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
- –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã
- –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥

### `examples.js` - –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å HTML/Markdown
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- –†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏
- –û–ø—Ä–æ—Å—ã –∏ –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã
- –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ callback
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —É—Ç–∏–ª–∏—Ç—ã

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```javascript
const BOT_TOKEN = "YOUR_BOT_TOKEN_HERE";
const WEBAPP_URL = "YOUR_WEBAPP_URL_HERE";

const Bot = TGbot.bot({ 
  botToken: BOT_TOKEN, 
  webAppUrl: WEBAPP_URL,
  logRequest: true 
});
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook
```javascript
function setupWebhook() {
  const result = Bot.setWebhook({
    url: WEBAPP_URL,
    max_connections: 50
  });
  console.log("Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:", result);
  return result;
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook
```javascript
function checkWebhook() {
  const info = Bot.getWebhookInfo();
  console.log("Webhook info:", info);
  return info;
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–µ
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —á–µ—Ä–µ–∑ `/stats`

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã
3. –°–æ–∑–¥–∞–π—Ç–µ –æ–ø—Ä–æ—Å—ã
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
5. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ

## üìà –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
```javascript
if (text === "/newcommand") {
  // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
  Bot.sendMessage({
    chat_id: chat_id,
    text: "–ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞!"
  });
}
```

### –†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞—Ñ–∞–π–ª–∞–º–∏
```javascript
if (msg.photo) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ
  const photo = msg.photo[msg.photo.length - 1];
  const file_id = photo.file_id;
}

if (msg.document) {
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  const file_id = msg.document.file_id;
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
```javascript
const Keyboard = TGbot.keyboard();
const Key = TGbot.key();

const keyboard = Keyboard.make([
  [Key.callback("–ö–Ω–æ–ø–∫–∞ 1", "action1")],
  [Key.url("–°—Å—ã–ª–∫–∞", "https://google.com")]
], { columns: 1 }).inline();

Bot.sendMessage({
  chat_id: chat_id,
  text: "–í—ã–±–µ—Ä–∏—Ç–µ:",
  reply_markup: keyboard
});
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ webhook: `checkWebhook()`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –ª–∏—Å—Ç–µ "Debug"

### –û—à–∏–±–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –∞–∫—Ç–∏–≤–Ω–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—Å—Ç "Errors"
4. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –ª–∏—Å—Ç—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π
1. –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É TGbot
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
3. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏

## üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
```javascript
function getMessageStats() {
  const sheet = ss.getSheetByName("Messages");
  const totalMessages = sheet.getLastRow() - 1;
  const todayMessages = getTodayMessages();
  
  return {
    total: totalMessages,
    today: todayMessages,
    average: totalMessages / getDaysActive()
  };
}
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
```javascript
function exportData() {
  const data = getDataForExport();
  const csvContent = convertToCSV(data);
  const blob = Utilities.newBlob(csvContent, MimeType.CSV, "data.csv");
  
  return blob;
}
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:
- ‚úÖ –†–∞–±–æ—Ç–∞—é—â–∏–π Telegram –±–æ—Ç
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **–ê–≤—Ç–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫–∏**: https://t.me/nosaev_m
- **–ö–∞–Ω–∞–ª –∞–≤—Ç–æ—Ä–∞**: https://zen.yandex.ru/excelifehack
- **–ì—Ä—É–ø–ø–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: https://t.me/googleappsscriptrc
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API**: https://core.telegram.org/bots/api

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª `src/LICENSE`

---

**–°–æ–∑–¥–∞–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ TGbot –≤ —Ä–∞–±–æ—Ç–µ —Å Google –¢–∞–±–ª–∏—Ü–∞–º–∏** 