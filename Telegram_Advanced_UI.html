<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å Telegram Bot</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #4F46E5;
      --primary-hover: #4338CA;
      --success-color: #10B981;
      --warning-color: #F59E0B;
      --error-color: #EF4444;
      --background-color: #F8FAFC;
      --container-bg: #FFFFFF;
      --text-color: #1F2937;
      --subtle-text: #6B7280;
      --border-color: #E5E7EB;
      --input-bg: #F9FAFB;
      --code-bg: #1F2937;
      --code-color: #F3F4F6;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--background-color);
      margin: 0;
      padding: 0;
      color: var(--text-color);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    .header {
      background-color: var(--container-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 1rem 2rem;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    .status-indicator {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
    }

    .status-connected {
      background-color: #D1FAE5;
      color: #065F46;
    }

    .status-disconnected {
      background-color: #FEE2E2;
      color: #991B1B;
    }

    .tab-bar {
      display: flex;
      overflow-x: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      background-color: var(--container-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 0 2rem;
    }

    .tab-bar::-webkit-scrollbar {
      display: none;
    }

    .tab-item {
      padding: 1rem 1.5rem;
      cursor: pointer;
      font-weight: 500;
      color: var(--subtle-text);
      border: 1px solid transparent;
      border-bottom: none;
      border-radius: 0.5rem 0.5rem 0 0;
      background-color: transparent;
      margin-right: 0.25rem;
      position: relative;
      top: 1px;
      transition: all 0.2s ease-in-out;
      white-space: nowrap;
    }
    
    .tab-item:hover {
      color: var(--primary-color);
      background-color: var(--background-color);
    }
    
    .tab-item.active {
      color: var(--primary-color);
      font-weight: 600;
      background-color: var(--container-bg);
      border-color: var(--border-color);
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      background-color: var(--container-bg);
      min-height: calc(100vh - 120px);
    }

    .content {
      padding: 2rem;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease-in-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text-color);
    }

    .form-input, .form-textarea, .form-select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      border-radius: 0.5rem;
      background-color: var(--input-bg);
      font-size: 0.875rem;
      transition: border-color 0.2s ease-in-out;
    }

    .form-input:focus, .form-textarea:focus, .form-select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
    }

    .form-textarea {
      resize: vertical;
      min-height: 100px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 0.5rem;
      font-weight: 500;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      text-decoration: none;
      gap: 0.5rem;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--primary-hover);
    }

    .btn-success {
      background-color: var(--success-color);
      color: white;
    }

    .btn-warning {
      background-color: var(--warning-color);
      color: white;
    }

    .btn-error {
      background-color: var(--error-color);
      color: white;
    }

    .btn-secondary {
      background-color: var(--input-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    .btn-secondary:hover {
      background-color: var(--border-color);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .grid {
      display: grid;
      gap: 1.5rem;
    }

    .grid-2 {
      grid-template-columns: repeat(2, 1fr);
    }

    .grid-3 {
      grid-template-columns: repeat(3, 1fr);
    }

    .card {
      background-color: var(--container-bg);
      border: 1px solid var(--border-color);
      border-radius: 0.75rem;
      padding: 1.5rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .card-title {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-color);
    }

    .alert {
      padding: 1rem;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
      font-size: 0.875rem;
    }

    .alert-success {
      background-color: #D1FAE5;
      color: #065F46;
      border: 1px solid #A7F3D0;
    }

    .alert-error {
      background-color: #FEE2E2;
      color: #991B1B;
      border: 1px solid #FCA5A5;
    }

    .alert-warning {
      background-color: #FEF3C7;
      color: #92400E;
      border: 1px solid #FCD34D;
    }

    .chat-container {
      display: flex;
      height: 600px;
      border: 1px solid var(--border-color);
      border-radius: 0.75rem;
      overflow: hidden;
    }

    .chat-sidebar {
      width: 300px;
      background-color: var(--input-bg);
      border-right: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
    }

    .chat-main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .chat-header {
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
      background-color: var(--container-bg);
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      background-color: var(--background-color);
    }

    .chat-input {
      padding: 1rem;
      border-top: 1px solid var(--border-color);
      background-color: var(--container-bg);
    }

    .message {
      margin-bottom: 1rem;
      padding: 0.75rem;
      border-radius: 0.5rem;
      max-width: 80%;
    }

    .message-outgoing {
      background-color: var(--primary-color);
      color: white;
      margin-left: auto;
    }

    .message-incoming {
      background-color: var(--container-bg);
      border: 1px solid var(--border-color);
    }

    .file-upload {
      border: 2px dashed var(--border-color);
      border-radius: 0.5rem;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: border-color 0.2s ease-in-out;
    }

    .file-upload:hover {
      border-color: var(--primary-color);
    }

    .file-upload.dragover {
      border-color: var(--primary-color);
      background-color: rgba(79, 70, 229, 0.05);
    }

    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-radius: 50%;
      border-top-color: var(--primary-color);
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .hidden {
      display: none;
    }

    .flex {
      display: flex;
    }

    .items-center {
      align-items: center;
    }

    .justify-between {
      justify-content: space-between;
    }

    .gap-2 {
      gap: 0.5rem;
    }

    .gap-4 {
      gap: 1rem;
    }

    .mb-4 {
      margin-bottom: 1rem;
    }

    .mt-4 {
      margin-top: 1rem;
    }

    .text-sm {
      font-size: 0.875rem;
    }

    .text-xs {
      font-size: 0.75rem;
    }

    .font-medium {
      font-weight: 500;
    }

    .text-center {
      text-align: center;
    }

    .user-item {
      padding: 0.75rem;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      transition: background-color 0.2s ease-in-out;
    }

    .user-item:hover {
      background-color: var(--background-color);
    }

    .flex-1 {
      flex: 1;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-content">
      <div class="header-title">ü§ñ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å Telegram Bot</div>
      <div id="statusIndicator" class="status-indicator status-disconnected">
        <div class="loading"></div>
        <span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...</span>
      </div>
    </div>
  </div>

  <div class="tab-bar">
    <div class="tab-item active" data-tab="messages">üì± –°–æ–æ–±—â–µ–Ω–∏—è</div>
    <div class="tab-item" data-tab="media">üì∑ –ú–µ–¥–∏–∞</div>
    <div class="tab-item" data-tab="keyboards">‚å®Ô∏è –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã</div>
    <div class="tab-item" data-tab="calendar">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</div>
    <div class="tab-item" data-tab="polls">üìä –û–ø—Ä–æ—Å—ã</div>
    <div class="tab-item" data-tab="chat">üí¨ –ß–∞—Ç</div>
    <div class="tab-item" data-tab="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
  </div>

  <div class="container">
    <div class="content">
      <!-- –í–∫–ª–∞–¥–∫–∞ –°–æ–æ–±—â–µ–Ω–∏—è -->
      <div id="messages" class="tab-content active">
        <div class="card">
          <div class="card-title">–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è</div>
          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
              <input type="text" id="messageUserId" class="form-input" placeholder="123456789">
            </div>
            <div class="form-group">
              <label class="form-label">–†–µ–∂–∏–º –ø–∞—Ä—Å–∏–Ω–≥–∞</label>
              <select id="messageParseMode" class="form-select">
                <option value="HTML">HTML</option>
                <option value="Markdown">Markdown</option>
                <option value="MarkdownV2">MarkdownV2</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</label>
            <textarea id="messageText" class="form-textarea" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è..."></textarea>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-primary" onclick="sendTextMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
            <button class="btn btn-secondary" onclick="clearMessageForm()">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –ú–µ–¥–∏–∞ -->
      <div id="media" class="tab-content">
        <div class="card">
          <div class="card-title">–û—Ç–ø—Ä–∞–≤–∫–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤</div>
          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
              <input type="text" id="mediaUserId" class="form-input" placeholder="123456789">
            </div>
            <div class="form-group">
              <label class="form-label">–¢–∏–ø –º–µ–¥–∏–∞</label>
              <select id="mediaType" class="form-select">
                <option value="photo">–§–æ—Ç–æ</option>
                <option value="video">–í–∏–¥–µ–æ</option>
                <option value="document">–î–æ–∫—É–º–µ–Ω—Ç</option>
                <option value="audio">–ê—É–¥–∏–æ</option>
                <option value="voice">–ì–æ–ª–æ—Å–æ–≤–æ–µ</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">–ü–æ–¥–ø–∏—Å—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <input type="text" id="mediaCaption" class="form-input" placeholder="–ü–æ–¥–ø–∏—Å—å –∫ —Ñ–∞–π–ª—É">
          </div>
          <div class="form-group">
            <label class="form-label">–§–∞–π–ª</label>
            <div class="file-upload" onclick="document.getElementById('mediaFile').click()">
              <div>üìÅ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</div>
              <input type="file" id="mediaFile" class="hidden" onchange="handleFileSelect(this)">
            </div>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-primary" onclick="sendMediaFile()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª</button>
            <button class="btn btn-secondary" onclick="clearMediaForm()">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã -->
      <div id="keyboards" class="tab-content">
        <div class="card">
          <div class="card-title">–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</div>
          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
              <input type="text" id="keyboardUserId" class="form-input" placeholder="123456789">
            </div>
            <div class="form-group">
              <label class="form-label">–¢–∏–ø –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã</label>
              <select id="keyboardType" class="form-select">
                <option value="reply">–û–±—ã—á–Ω–∞—è</option>
                <option value="inline">–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è</option>
                <option value="remove">–£–¥–∞–ª–∏—Ç—å</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</label>
            <textarea id="keyboardText" class="form-textarea" placeholder="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π"></textarea>
          </div>
          <div class="form-group">
            <label class="form-label">–ö–Ω–æ–ø–∫–∏ (–ø–æ –æ–¥–Ω–æ–π –Ω–∞ —Å—Ç—Ä–æ–∫—É)</label>
            <textarea id="keyboardButtons" class="form-textarea" placeholder="–ö–Ω–æ–ø–∫–∞ 1&#10;–ö–Ω–æ–ø–∫–∞ 2&#10;–ö–Ω–æ–ø–∫–∞ 3"></textarea>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-primary" onclick="sendKeyboard()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É</button>
            <button class="btn btn-secondary" onclick="clearKeyboardForm()">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –ö–∞–ª–µ–Ω–¥–∞—Ä—å -->
      <div id="calendar" class="tab-content">
        <div class="card">
          <div class="card-title">–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è</div>
          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
              <input type="text" id="calendarUserId" class="form-input" placeholder="123456789">
            </div>
            <div class="form-group">
              <label class="form-label">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</label>
              <input type="text" id="calendarText" class="form-input" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:" value="–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:">
            </div>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-primary" onclick="sendCalendar()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å</button>
            <button class="btn btn-secondary" onclick="clearCalendarForm()">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –û–ø—Ä–æ—Å—ã -->
      <div id="polls" class="tab-content">
        <div class="card">
          <div class="card-title">–°–æ–∑–¥–∞–Ω–∏–µ –æ–ø—Ä–æ—Å–∞</div>
          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label">ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
              <input type="text" id="pollUserId" class="form-input" placeholder="123456789">
            </div>
            <div class="form-group">
              <label class="form-label">–¢–∏–ø –æ–ø—Ä–æ—Å–∞</label>
              <select id="pollType" class="form-select">
                <option value="regular">–û–±—ã—á–Ω—ã–π –æ–ø—Ä–æ—Å</option>
                <option value="quiz">–í–∏–∫—Ç–æ—Ä–∏–Ω–∞</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">–í–æ–ø—Ä–æ—Å</label>
            <input type="text" id="pollQuestion" class="form-input" placeholder="–í–∞—à –≤–æ–ø—Ä–æ—Å?">
          </div>
          <div class="form-group">
            <label class="form-label">–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)</label>
            <textarea id="pollOptions" class="form-textarea" placeholder="–í–∞—Ä–∏–∞–Ω—Ç 1&#10;–í–∞—Ä–∏–∞–Ω—Ç 2&#10;–í–∞—Ä–∏–∞–Ω—Ç 3"></textarea>
          </div>
          <div id="quizOptions" class="hidden">
            <div class="grid grid-2">
              <div class="form-group">
                <label class="form-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (–Ω–æ–º–µ—Ä)</label>
                <input type="number" id="pollCorrectOption" class="form-input" min="0" placeholder="0">
              </div>
              <div class="form-group">
                <label class="form-label">–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</label>
                <input type="text" id="pollExplanation" class="form-input" placeholder="–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞">
              </div>
            </div>
          </div>
          <div class="flex gap-2">
            <button class="btn btn-primary" onclick="sendPoll()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–ø—Ä–æ—Å</button>
            <button class="btn btn-secondary" onclick="clearPollForm()">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –ß–∞—Ç -->
      <div id="chat" class="tab-content">
        <div class="chat-container">
          <div class="chat-sidebar">
            <div class="card-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
            <div id="usersList" class="flex-1">
              <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
            </div>
          </div>
          <div class="chat-main">
            <div class="chat-header">
              <div id="selectedUser">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –Ω–∞—á–∞–ª–∞ —á–∞—Ç–∞</div>
            </div>
            <div id="chatMessages" class="chat-messages">
              <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
            </div>
            <div class="chat-input">
              <div class="flex gap-2">
                <input type="text" id="chatInput" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="handleChatKeyPress(event)">
                <button class="btn btn-primary" onclick="sendChatMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
      <div id="settings" class="tab-content">
        <div class="grid grid-2">
          <div class="card">
            <div class="card-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞</div>
            <div class="form-group">
              <label class="form-label">–¢–æ–∫–µ–Ω –±–æ—Ç–∞</label>
              <input type="password" id="botToken" class="form-input" placeholder="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz">
            </div>
            <div class="form-group">
              <label class="form-label">URL –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</label>
              <input type="text" id="webAppUrl" class="form-input" placeholder="https://script.google.com/macros/s/...">
            </div>
            <div class="flex gap-2">
              <button class="btn btn-primary" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
              <button class="btn btn-secondary" onclick="loadSettings()">–ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
              <button class="btn btn-success" onclick="autoSetupWebhookUrl()">–ê–≤—Ç–æ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ URL</button>
            </div>
          </div>

          <div class="card">
            <div class="card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ webhook</div>
            <div class="flex gap-2 mb-4">
              <button class="btn btn-success" onclick="setWebhook()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook</button>
              <button class="btn btn-warning" onclick="getWebhookInfo()">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
              <button class="btn btn-error" onclick="deleteWebhook()">–£–¥–∞–ª–∏—Ç—å webhook</button>
            </div>
            <div id="webhookInfo" class="text-sm">
              <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ webhook –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∞ –∑–¥–µ—Å—å -->
            </div>
          </div>
        </div>

        <div class="card mt-4">
          <div class="card-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</div>
          <div id="usageStats" class="text-sm">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∑–¥–µ—Å—å -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let selectedUserId = null;
    let selectedFile = null;

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', function() {
      initializeTabs();
      checkBotStatus();
      loadSettings();
      loadUsersList();
      loadUsageStats();
    });

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
    function initializeTabs() {
      const tabItems = document.querySelectorAll('.tab-item');
      const tabContents = document.querySelectorAll('.tab-content');

      tabItems.forEach(tab => {
        tab.addEventListener('click', () => {
          const targetTab = tab.getAttribute('data-tab');
          
          // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
          tabItems.forEach(t => t.classList.remove('active'));
          tabContents.forEach(t => t.classList.remove('active'));
          
          // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
          tab.classList.add('active');
          document.getElementById(targetTab).classList.add('active');
        });
      });
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞
    function checkBotStatus() {
      google.script.run
        .withSuccessHandler(handleStatusResponse)
        .withFailureHandler(handleStatusError)
        .checkBotStatus();
    }

    function handleStatusResponse(response) {
      const statusIndicator = document.getElementById('statusIndicator');
      if (response.success) {
        statusIndicator.className = 'status-indicator status-connected';
        statusIndicator.innerHTML = `
          <div style="width: 8px; height: 8px; background-color: #10B981; border-radius: 50%;"></div>
          <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–æ: ${response.data.botName}</span>
        `;
      } else {
        statusIndicator.className = 'status-indicator status-disconnected';
        statusIndicator.innerHTML = `
          <div style="width: 8px; height: 8px; background-color: #EF4444; border-radius: 50%;"></div>
          <span>–û—à–∏–±–∫–∞: ${response.error}</span>
        `;
      }
    }

    function handleStatusError(error) {
      const statusIndicator = document.getElementById('statusIndicator');
      statusIndicator.className = 'status-indicator status-disconnected';
      statusIndicator.innerHTML = `
        <div style="width: 8px; height: 8px; background-color: #EF4444; border-radius: 50%;"></div>
        <span>–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</span>
      `;
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –°–æ–æ–±—â–µ–Ω–∏—è
    function sendTextMessage() {
      const userId = document.getElementById('messageUserId').value;
      const text = document.getElementById('messageText').value;
      const parseMode = document.getElementById('messageParseMode').value;

      if (!userId || !text) {
        showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
        return;
      }

      google.script.run
        .withSuccessHandler(handleMessageResponse)
        .withFailureHandler(handleMessageError)
        .sendTextMessage(userId, text, parseMode);
    }

    function handleMessageResponse(response) {
      if (response.success) {
        showAlert('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ!', 'success');
        clearMessageForm();
      } else {
        showAlert(`–û—à–∏–±–∫–∞: ${response.error}`, 'error');
      }
    }

    function handleMessageError(error) {
      showAlert(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }

    function clearMessageForm() {
      document.getElementById('messageUserId').value = '';
      document.getElementById('messageText').value = '';
      document.getElementById('messageParseMode').value = 'HTML';
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –ú–µ–¥–∏–∞
    function handleFileSelect(input) {
      const file = input.files[0];
      if (file) {
        selectedFile = file;
        const uploadArea = document.querySelector('.file-upload');
        uploadArea.innerHTML = `
          <div>üìÅ ${file.name} (${(file.size / 1024).toFixed(1)} KB)</div>
        `;
      }
    }

    function sendMediaFile() {
      const userId = document.getElementById('mediaUserId').value;
      const mediaType = document.getElementById('mediaType').value;
      const caption = document.getElementById('mediaCaption').value;

      if (!userId || !selectedFile) {
        showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª', 'error');
        return;
      }

      // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞
      showAlert('–§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'warning');
    }

    function clearMediaForm() {
      document.getElementById('mediaUserId').value = '';
      document.getElementById('mediaCaption').value = '';
      document.getElementById('mediaFile').value = '';
      selectedFile = null;
      document.querySelector('.file-upload').innerHTML = 'üìÅ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ –∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞';
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    function sendKeyboard() {
      const userId = document.getElementById('keyboardUserId').value;
      const text = document.getElementById('keyboardText').value;
      const keyboardType = document.getElementById('keyboardType').value;
      const buttonsText = document.getElementById('keyboardButtons').value;

      if (!userId || !text) {
        showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è', 'error');
        return;
      }

      const buttons = buttonsText.split('\n').filter(btn => btn.trim());
      
      google.script.run
        .withSuccessHandler(handleKeyboardResponse)
        .withFailureHandler(handleKeyboardError)
        .sendKeyboard(userId, text, buttons, keyboardType);
    }

    function handleKeyboardResponse(response) {
      if (response.success) {
        showAlert('–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!', 'success');
        clearKeyboardForm();
      } else {
        showAlert(`–û—à–∏–±–∫–∞: ${response.error}`, 'error');
      }
    }

    function handleKeyboardError(error) {
      showAlert(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }

    function clearKeyboardForm() {
      document.getElementById('keyboardUserId').value = '';
      document.getElementById('keyboardText').value = '';
      document.getElementById('keyboardButtons').value = '';
      document.getElementById('keyboardType').value = 'reply';
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –ö–∞–ª–µ–Ω–¥–∞—Ä—å
    function sendCalendar() {
      const userId = document.getElementById('calendarUserId').value;
      const text = document.getElementById('calendarText').value;

      if (!userId) {
        showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
        return;
      }

      google.script.run
        .withSuccessHandler(handleCalendarResponse)
        .withFailureHandler(handleCalendarError)
        .sendCalendar(userId, text);
    }

    function handleCalendarResponse(response) {
      if (response.success) {
        showAlert('–ö–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
        clearCalendarForm();
      } else {
        showAlert(`–û—à–∏–±–∫–∞: ${response.error}`, 'error');
      }
    }

    function handleCalendarError(error) {
      showAlert(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }

    function clearCalendarForm() {
      document.getElementById('calendarUserId').value = '';
      document.getElementById('calendarText').value = '–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É:';
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –û–ø—Ä–æ—Å—ã
    document.getElementById('pollType').addEventListener('change', function() {
      const quizOptions = document.getElementById('quizOptions');
      if (this.value === 'quiz') {
        quizOptions.classList.remove('hidden');
      } else {
        quizOptions.classList.add('hidden');
      }
    });

    function sendPoll() {
      const userId = document.getElementById('pollUserId').value;
      const question = document.getElementById('pollQuestion').value;
      const pollType = document.getElementById('pollType').value;
      const optionsText = document.getElementById('pollOptions').value;
      const correctOption = document.getElementById('pollCorrectOption').value;
      const explanation = document.getElementById('pollExplanation').value;

      if (!userId || !question || !optionsText) {
        showAlert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
        return;
      }

      const options = optionsText.split('\n').filter(opt => opt.trim());
      if (options.length < 2) {
        showAlert('–î–æ–±–∞–≤—å—Ç–µ –º–∏–Ω–∏–º—É–º 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞', 'error');
        return;
      }

      const isQuiz = pollType === 'quiz';
      const correctOptionId = isQuiz && correctOption ? parseInt(correctOption) : null;

      google.script.run
        .withSuccessHandler(handlePollResponse)
        .withFailureHandler(handlePollError)
        .sendPoll(userId, question, options, isQuiz, correctOptionId, explanation);
    }

    function handlePollResponse(response) {
      if (response.success) {
        showAlert('–û–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
        clearPollForm();
      } else {
        showAlert(`–û—à–∏–±–∫–∞: ${response.error}`, 'error');
      }
    }

    function handlePollError(error) {
      showAlert(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }

    function clearPollForm() {
      document.getElementById('pollUserId').value = '';
      document.getElementById('pollQuestion').value = '';
      document.getElementById('pollOptions').value = '';
      document.getElementById('pollType').value = 'regular';
      document.getElementById('pollCorrectOption').value = '';
      document.getElementById('pollExplanation').value = '';
      document.getElementById('quizOptions').classList.add('hidden');
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –ß–∞—Ç
    function loadUsersList() {
      google.script.run
        .withSuccessHandler(handleUsersResponse)
        .withFailureHandler(handleUsersError)
        .getUsersList();
    }

    function handleUsersResponse(users) {
      const usersList = document.getElementById('usersList');
      if (users.length === 0) {
        usersList.innerHTML = '<div class="text-center text-sm text-gray-500">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
        return;
      }

      usersList.innerHTML = users.map(user => `
        <div class="user-item" onclick="selectUser('${user.id}', '${user.name}')">
          <div class="font-medium">${user.name}</div>
          <div class="text-xs text-gray-500">ID: ${user.id}</div>
        </div>
      `).join('');
    }

    function handleUsersError(error) {
      const usersList = document.getElementById('usersList');
      usersList.innerHTML = `<div class="text-center text-sm text-red-500">–û—à–∏–±–∫–∞: ${error.message}</div>`;
    }

    function selectUser(userId, userName) {
      selectedUserId = userId;
      document.getElementById('selectedUser').textContent = `–ß–∞—Ç —Å ${userName}`;
      loadChatHistory(userId);
    }

    function loadChatHistory(userId) {
      google.script.run
        .withSuccessHandler(handleChatHistoryResponse)
        .withFailureHandler(handleChatHistoryError)
        .getUserChatHistory(userId);
    }

    function handleChatHistoryResponse(response) {
      const chatMessages = document.getElementById('chatMessages');
      if (response.success) {
        chatMessages.innerHTML = response.data.map(message => `
          <div class="message message-incoming">
            <div class="text-sm text-gray-500">${new Date(message.date).toLocaleString()}</div>
            <div>${message.message}</div>
          </div>
        `).join('');
        chatMessages.scrollTop = chatMessages.scrollHeight;
      } else {
        chatMessages.innerHTML = `<div class="text-center text-sm text-red-500">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏: ${response.error}</div>`;
      }
    }

    function handleChatHistoryError(error) {
      const chatMessages = document.getElementById('chatMessages');
      chatMessages.innerHTML = `<div class="text-center text-sm text-red-500">–û—à–∏–±–∫–∞: ${error.message}</div>`;
    }

    function handleChatKeyPress(event) {
      if (event.key === 'Enter') {
        sendChatMessage();
      }
    }

    function sendChatMessage() {
      const input = document.getElementById('chatInput');
      const text = input.value.trim();

      if (!selectedUserId || !text) {
        return;
      }

      // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
      const chatMessages = document.getElementById('chatMessages');
      chatMessages.innerHTML += `
        <div class="message message-outgoing">
          <div class="text-sm">${new Date().toLocaleString()}</div>
          <div>${text}</div>
        </div>
      `;
      chatMessages.scrollTop = chatMessages.scrollHeight;

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
      google.script.run
        .withSuccessHandler(handleChatMessageResponse)
        .withFailureHandler(handleChatMessageError)
        .sendTextMessage(selectedUserId, text);

      input.value = '';
    }

    function handleChatMessageResponse(response) {
      if (!response.success) {
        showAlert(`–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${response.error}`, 'error');
      }
    }

    function handleChatMessageError(error) {
      showAlert(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏ –ù–∞—Å—Ç—Ä–æ–π–∫–∏
    function saveSettings() {
      const botToken = document.getElementById('botToken').value;
      const webAppUrl = document.getElementById('webAppUrl').value;

      if (!botToken) {
        showAlert('–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞', 'error');
        return;
      }

      google.script.run
        .withSuccessHandler(handleSaveSettingsResponse)
        .withFailureHandler(handleSaveSettingsError)
        .saveSettings({ BOT_TOKEN: botToken, WEBAPP_URL: webAppUrl });
    }

    function handleSaveSettingsResponse(response) {
      if (response.success) {
        showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!', 'success');
        checkBotStatus();
      } else {
        showAlert(`–û—à–∏–±–∫–∞: ${response.error}`, 'error');
      }
    }

    function handleSaveSettingsError(error) {
      showAlert(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
    }

    function loadSettings() {
      google.script.run
        .withSuccessHandler(handleLoadSettingsResponse)
        .withFailureHandler(handleLoadSettingsError)
        .getSettings();
    }

    function handleLoadSettingsResponse(settings) {
      document.getElementById('botToken').value = settings.BOT_TOKEN || '';
      document.getElementById('webAppUrl').value = settings.WEBAPP_URL || '';
    }

    function handleLoadSettingsError(error) {
      showAlert(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ${error.message}`, 'error');
    }

    function autoSetupWebhookUrl() {
      google.script.run
        .withSuccessHandler(handleAutoSetupResponse)
        .withFailureHandler(handleAutoSetupError)
        .autoSetupWebhookUrl();
    }

    function handleAutoSetupResponse(response) {
      if (response.success) {
        showAlert(`‚úÖ ${response.data.message}: ${response.data.webAppUrl}`, 'success');
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–µ URL
        document.getElementById('webAppUrl').value = response.data.webAppUrl;
      } else {
        showAlert(`‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏: ${response.error}`, 'error');
      }
    }

    function handleAutoSetupError(error) {
      showAlert(`‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏: ${error.message}`, 'error');
    }

    function setWebhook() {
      google.script.run
        .withSuccessHandler(handleWebhookResponse)
        .withFailureHandler(handleWebhookError)
        .setWebhook();
    }

    function getWebhookInfo() {
      google.script.run
        .withSuccessHandler(handleWebhookInfoResponse)
        .withFailureHandler(handleWebhookError)
        .getWebhookInfo();
    }

    function deleteWebhook() {
      google.script.run
        .withSuccessHandler(handleWebhookResponse)
        .withFailureHandler(handleWebhookError)
        .deleteWebhook();
    }

    function handleWebhookResponse(response) {
      if (response.success) {
        showAlert('Webhook –æ–±–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
        getWebhookInfo();
      } else {
        showAlert(`–û—à–∏–±–∫–∞: ${response.error}`, 'error');
      }
    }

    function handleWebhookInfoResponse(response) {
      const webhookInfo = document.getElementById('webhookInfo');
      if (response.success && response.data && response.data.result) {
        webhookInfo.innerHTML = `
          <div><strong>URL:</strong> ${response.data.result.url || '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</div>
          <div><strong>–°—Ç–∞—Ç—É—Å:</strong> ${response.data.result.pending_update_count || 0} –æ–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</div>
          <div><strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞:</strong> ${response.data.result.last_error_message || '–ù–µ—Ç'}</div>
        `;
      } else {
        webhookInfo.innerHTML = `<div class="text-red-500">–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: ${response.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}</div>`;
      }
    }

    function handleWebhookError(error) {
      showAlert(`–û—à–∏–±–∫–∞ webhook: ${error.message}`, 'error');
    }

    function loadUsageStats() {
      google.script.run
        .withSuccessHandler(handleStatsResponse)
        .withFailureHandler(handleStatsError)
        .getUsageStatistics();
    }

    function handleStatsResponse(response) {
      const statsContainer = document.getElementById('usageStats');
      if (response.success) {
        const stats = response.data;
        statsContainer.innerHTML = `
          <div class="grid grid-3">
            <div><strong>–í—Å–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏–π:</strong> ${stats.totalActions}</div>
            <div><strong>–£—Å–ø–µ—à–Ω—ã—Ö:</strong> ${stats.successfulActions}</div>
            <div><strong>–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞:</strong> ${stats.successRate}%</div>
          </div>
          <div class="mt-4">
            <strong>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:</strong>
            <div class="text-xs">
              ${stats.recentActions.map(action => `
                <div>${new Date(action.date).toLocaleString()} - ${action.action} (${action.status})</div>
              `).join('')}
            </div>
          </div>
        `;
      } else {
        statsContainer.innerHTML = `<div class="text-red-500">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>`;
      }
    }

    function handleStatsError(error) {
      const statsContainer = document.getElementById('usageStats');
      statsContainer.innerHTML = `<div class="text-red-500">–û—à–∏–±–∫–∞: ${error.message}</div>`;
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    function showAlert(message, type = 'info') {
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert alert-${type}`;
      alertDiv.textContent = message;
      
      const container = document.querySelector('.content');
      container.insertBefore(alertDiv, container.firstChild);
      
      setTimeout(() => {
        alertDiv.remove();
      }, 5000);
    }

    // Drag & Drop –¥–ª—è —Ñ–∞–π–ª–æ–≤
    document.addEventListener('DOMContentLoaded', function() {
      const fileUpload = document.querySelector('.file-upload');
      
      fileUpload.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.classList.add('dragover');
      });
      
      fileUpload.addEventListener('dragleave', function(e) {
        e.preventDefault();
        this.classList.remove('dragover');
      });
      
      fileUpload.addEventListener('drop', function(e) {
        e.preventDefault();
        this.classList.remove('dragover');
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          selectedFile = files[0];
          this.innerHTML = `
            <div>üìÅ ${files[0].name} (${(files[0].size / 1024).toFixed(1)} KB)</div>
          `;
        }
      });
    });
  </script>
</body>
</html> 